/**
 * Disposable Email Domain Blocklist
 *
 * This list contains known temporary/disposable email service domains
 * to prevent abuse of the guest authentication system.
 *
 * Sources:
 * - https://github.com/disposable/disposable-email-domains
 * - Manual curation of popular temporary email services
 *
 * Last updated: 2026-01-19
 */

export const disposableDomains = new Set([
  // Popular temporary email services
  '10minutemail.com',
  '10minutemail.net',
  'guerrillamail.com',
  'guerrillamail.net',
  'guerrillamail.org',
  'guerrillamail.biz',
  'guerrillamailblock.com',
  'tempmail.com',
  'temp-mail.org',
  'temp-mail.io',
  'throwaway.email',
  'throwawaymail.com',
  'mailinator.com',
  'mailinator2.com',
  'mailtothis.com',
  'trashmail.com',
  'trash-mail.com',
  'sharklasers.com',
  'yopmail.com',
  'yopmail.fr',
  'yopmail.net',
  'cool.fr.nf',
  'jetable.fr.nf',
  'nospam.ze.tc',
  'nomail.xl.cx',
  'mega.zik.dj',
  'speed.1s.fr',
  'courriel.fr.nf',
  'moncourrier.fr.nf',
  'monemail.fr.nf',
  'monmail.fr.nf',
  'hide.biz.st',
  'mymail.infos.st',
  'getnada.com',
  'mohmal.com',
  'fakeinbox.com',
  'temp-inbox.com',
  'emailondeck.com',
  'spamgourmet.com',
  'mytemp.email',
  'tmpmail.org',
  'tmpmail.net',
  'dispostable.com',
  'mintemail.com',
  'emailtemporanea.com',
  'emailtemporanea.net',
  'emailtemporary.com',
  'emkei.cf',
  'emkei.ga',
  'emkei.gq',
  'emkei.ml',
  'emkei.tk',
  'inboxbear.com',
  'dropmail.me',
  'harakirimail.com',
  'incognitomail.com',
  'incognitomail.net',
  'incognitomail.org',
  'mailcatch.com',
  'maildrop.cc',
  'mailexpire.com',
  'mailin8r.com',
  'mailnesia.com',
  'mailsac.com',
  'mailtmp.com',
  'mintmail.biz',
  'mytrashmail.com',
  'nwldx.com',
  'noclickemail.com',
  'privymail.de',
  'rootprompt.org',
  'sneakemail.com',
  'spambog.com',
  'spambog.de',
  'spambog.ru',
  'spambox.us',
  'spamex.com',
  'spaml.com',
  'spaml.de',
  'spammotel.com',
  'superrito.com',
  'tempemail.com',
  'tempemail.net',
  'tempinbox.com',
  'tempinbox.co.uk',
  'tempmailaddress.com',
  'tmailinator.com',
  'trillianpro.com',
  'veryrealemail.com',
  'wegwerfemail.de',
  'wegwerfmail.de',
  'wegwerfmail.net',
  'wegwerfmail.org',
  'winemaven.info',
  'xoxy.net',
  'zoemail.com',
  'zoemail.net',
  'zoemail.org',
  'zoemail.com',
  'banana.email',
  'inboxkitten.com',
  'protonmail.com', // Often used for throwaway accounts
  'cock.li', // Known for abuse
  'zetmail.com',
  'e4ward.com',
  'getairmail.com',
  'getairmail.cf',
  'getairmail.ga',
  'getairmail.gq',
  'getairmail.ml',
  'getairmail.tk',
  'armyspy.com',
  'cuvox.de',
  'dayrep.com',
  'einrot.com',
  'fleckens.hu',
  'gustr.com',
  'jourrapide.com',
  'rhyta.com',
  'superrito.com',
  'teleworm.us',
  '0-mail.com',
  '0815.ru',
  '0clickemail.com',
  '10mail.org',
  '20minutemail.com',
  '2prong.com',
  '30minutemail.com',
  '33mail.com',
  '3d-painting.com',
  '4warding.com',
  '4warding.net',
  '4warding.org',
  '60minutemail.com',
  '675hosting.com',
  '675hosting.net',
  '675hosting.org',
  '9ox.net',
  'a-bc.net',
  'abusemail.de',
  'abyssmail.com',
  'afrobacon.com',
  'ajaxapp.net',
  'akapost.com',
  'ama-trade.de',
  'amilegit.com',
  'amiri.net',
  'amiriindustries.com',
  'anonbox.net',
  'anonymbox.com',
  'antichef.com',
  'antichef.net',
  'antireg.ru',
  'antispam.de',
  'antispammail.de',
  'baxomale.ht.cx',
  'beefmilk.com',
  'binkmail.com',
  'bio-muesli.net',
  'bobmail.info',
  'bodhi.lawlita.com',
  'bofthew.com',
  'bootybay.de',
  'boun.cr',
  'bouncr.com',
  'breakthru.com',
  'brefmail.com',
  'broadbandninja.com',
  'bsnow.net',
  'bspamfree.org',
  'buffemail.com',
  'bugmenot.com',
  'bumpymail.com',
  'bund.us',
  'burnthespam.info',
  'burstmail.info',
  'buymoreplays.com',
  'byom.de',
  'c2.hu',
  'cachedot.net',
  'calm.lu',
  'cartelera.org',
  'caseedu.tk',
  'cellurl.com',
  'centermail.com',
  'centermail.net',
  'cetpass.com',
  'childsavetrust.org',
  'chogmail.com',
  'choicemail1.com',
  'clixser.com',
  'cmail.net',
  'cmail.org',
  'coldemail.info',
  'cool.fr.nf',
  'correo.blogos.net',
  'cosmorph.com',
  'courrieltemporaire.com',
  'cubiclink.com',
  'curryworld.de',
  'cust.in',
  'cuvox.de',
  'd3p.dk',
  'dacoolest.com',
  'dandikmail.com',
  'dayrep.com',
  'dbunker.com',
  'dcemail.com',
  'deadaddress.com',
  'deadspam.com',
  'deagot.com',
  'dealja.com',
  'despam.it',
  'despammed.com',
  'devnullmail.com',
  'dfgh.net',
  'digitalsanctuary.com',
  'dingbone.com',
  'disbox.net',
  'disbox.org',
  'discard.cf',
  'discard.email',
  'discard.ga',
  'discard.gq',
  'discard.ml',
  'discard.tk',
  'discardmail.com',
  'discardmail.de',
  'disposable.cf',
  'disposable.ga',
  'disposable.ml',
  'disposableaddress.com',
  'disposableemailaddresses.com',
  'disposableinbox.com',
  'dispose.it',
  'disposeamail.com',
  'disposemail.com',
  'dispostable.com',
  'dm.w3internet.co.ukexample.com',
  'dodgeit.com',
  'dodgit.com',
  'dodgit.org',
  'donemail.ru',
  'dontreg.com',
  'dontsendmespam.de',
  'drdrb.com',
  'drdrb.net',
  'dump-email.info',
  'dumpandjunk.com',
  'dumpmail.de',
  'dumpyemail.com',
  'e-mail.com',
  'e-mail.org',
  'e4ward.com',
  'easytrashmail.com',
  'einmalmail.de',
  'einrot.com',
  'email-fake.cf',
  'email-fake.com',
  'email-fake.ga',
  'email-fake.gq',
  'email-fake.ml',
  'email-fake.tk',
  'email60.com',
  'emailage.cf',
  'emailage.ga',
  'emailage.gq',
  'emailage.ml',
  'emailage.tk',
  'emaildienst.de',
  'emailgo.de',
  'emailias.com',
  'emailigo.de',
  'emailinfive.com',
  'emailisvalid.com',
  'emaillime.com',
  'emailmiser.com',
  'emailproxsy.com',
  'emails.ga',
  'emailsensei.com',
  'emailsingularity.net',
  'emailspam.cf',
  'emailspam.ga',
  'emailspam.gq',
  'emailspam.ml',
  'emailspam.tk',
  'emailtemporanea.com',
  'emailtemporanea.net',
  'emailtemporar.ro',
  'emailtemporario.com.br',
  'emailthe.net',
  'emailtmp.com',
  'emailto.de',
  'emailwarden.com',
  'emailx.at.hm',
  'emailxfer.com',
  'emeil.in',
  'emeil.ir',
  'emeraldwebmail.com',
  'emltmp.com',
  'emz.net',
  'enterto.com',
  'ephemail.net',
  'est.une.victime.ninja',
  'etranquil.com',
  'etranquil.net',
  'etranquil.org',
  'evopo.com',
  'explodemail.com',
  'express.net.ua',
  'eyepaste.com',
  'fakeinbox.cf',
  'fakeinbox.com',
  'fakeinbox.ga',
  'fakeinbox.ml',
  'fakeinbox.tk',
  'fakemail.fr',
  'fakemailgenerator.com',
  'fakemailz.com',
  'fammix.com',
  'fansworldwide.de',
  'fantasymail.de',
  'fastacura.com',
  'fastchevy.com',
  'fastchrysler.com',
  'fastkawasaki.com',
  'fastmazda.com',
  'fastmitsubishi.com',
  'fastnissan.com',
  'fastsubaru.com',
  'fastsuzuki.com',
  'fasttoyota.com',
  'fastyamaha.com',
  'fatflap.com',
  'fdfdsfds.com',
  'fightallspam.com',
  'fiifke.de',
  'filzmail.com',
  'fivemail.de',
  'fixmail.tk',
  'fizmail.com',
  'fleckens.hu',
  'fly-ts.de',
  'flyspam.com',
  'footard.com',
  'forgetmail.com',
  'fornow.eu',
  'fr33mail.info',
  'frapmail.com',
  'freedom.gq',
  'freemails.cf',
  'freemails.ga',
  'freemails.ml',
  'freundin.ru',
  'fuckingduh.com',
  'fudgerub.com',
  'fun64.com',
  'fun64.net',
  'fuwamofu.com',
])

/**
 * Check if an email domain is in the disposable email blocklist
 *
 * @param email - The email address to check
 * @returns true if the domain is disposable, false otherwise
 */
export function isDisposableEmail(email: string): boolean {
  if (!email || typeof email !== 'string') {
    return false
  }

  const parts = email.toLowerCase().trim().split('@')
  if (parts.length !== 2) {
    return false
  }

  const domain = parts[1]
  return disposableDomains.has(domain)
}

/**
 * Get a user-friendly error message for disposable email rejection
 */
export const DISPOSABLE_EMAIL_ERROR =
  'Disposable email addresses are not allowed. Please use a permanent email address.'
